<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="Source to the Rust file `/home/josh/.cargo/git/checkouts/shams-4265f358b2964b2c/master/src/lib.rs`.">
    <meta name="keywords" content="rust, rustlang, rust-lang">

    <title>lib.rs.html -- source</title>

    <link rel="stylesheet" type="text/css" href="../../main.css">

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <section class="sidebar">
        
        
    </section>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press 'S' to search, '?' for more options..."
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content source"><pre class="line-numbers"><span id="1">  1</span>
<span id="2">  2</span>
<span id="3">  3</span>
<span id="4">  4</span>
<span id="5">  5</span>
<span id="6">  6</span>
<span id="7">  7</span>
<span id="8">  8</span>
<span id="9">  9</span>
<span id="10"> 10</span>
<span id="11"> 11</span>
<span id="12"> 12</span>
<span id="13"> 13</span>
<span id="14"> 14</span>
<span id="15"> 15</span>
<span id="16"> 16</span>
<span id="17"> 17</span>
<span id="18"> 18</span>
<span id="19"> 19</span>
<span id="20"> 20</span>
<span id="21"> 21</span>
<span id="22"> 22</span>
<span id="23"> 23</span>
<span id="24"> 24</span>
<span id="25"> 25</span>
<span id="26"> 26</span>
<span id="27"> 27</span>
<span id="28"> 28</span>
<span id="29"> 29</span>
<span id="30"> 30</span>
<span id="31"> 31</span>
<span id="32"> 32</span>
<span id="33"> 33</span>
<span id="34"> 34</span>
<span id="35"> 35</span>
<span id="36"> 36</span>
<span id="37"> 37</span>
<span id="38"> 38</span>
<span id="39"> 39</span>
<span id="40"> 40</span>
<span id="41"> 41</span>
<span id="42"> 42</span>
<span id="43"> 43</span>
<span id="44"> 44</span>
<span id="45"> 45</span>
<span id="46"> 46</span>
<span id="47"> 47</span>
<span id="48"> 48</span>
<span id="49"> 49</span>
<span id="50"> 50</span>
<span id="51"> 51</span>
<span id="52"> 52</span>
<span id="53"> 53</span>
<span id="54"> 54</span>
<span id="55"> 55</span>
<span id="56"> 56</span>
<span id="57"> 57</span>
<span id="58"> 58</span>
<span id="59"> 59</span>
<span id="60"> 60</span>
<span id="61"> 61</span>
<span id="62"> 62</span>
<span id="63"> 63</span>
<span id="64"> 64</span>
<span id="65"> 65</span>
<span id="66"> 66</span>
<span id="67"> 67</span>
<span id="68"> 68</span>
<span id="69"> 69</span>
<span id="70"> 70</span>
<span id="71"> 71</span>
<span id="72"> 72</span>
<span id="73"> 73</span>
<span id="74"> 74</span>
<span id="75"> 75</span>
<span id="76"> 76</span>
<span id="77"> 77</span>
<span id="78"> 78</span>
<span id="79"> 79</span>
<span id="80"> 80</span>
<span id="81"> 81</span>
<span id="82"> 82</span>
<span id="83"> 83</span>
<span id="84"> 84</span>
<span id="85"> 85</span>
<span id="86"> 86</span>
<span id="87"> 87</span>
<span id="88"> 88</span>
<span id="89"> 89</span>
<span id="90"> 90</span>
<span id="91"> 91</span>
<span id="92"> 92</span>
<span id="93"> 93</span>
<span id="94"> 94</span>
<span id="95"> 95</span>
<span id="96"> 96</span>
<span id="97"> 97</span>
<span id="98"> 98</span>
<span id="99"> 99</span>
<span id="100">100</span>
<span id="101">101</span>
<span id="102">102</span>
<span id="103">103</span>
<span id="104">104</span>
<span id="105">105</span>
<span id="106">106</span>
<span id="107">107</span>
<span id="108">108</span>
<span id="109">109</span>
<span id="110">110</span>
<span id="111">111</span>
<span id="112">112</span>
<span id="113">113</span>
<span id="114">114</span>
<span id="115">115</span>
<span id="116">116</span>
<span id="117">117</span>
<span id="118">118</span>
<span id="119">119</span>
<span id="120">120</span>
<span id="121">121</span>
<span id="122">122</span>
<span id="123">123</span>
<span id="124">124</span>
<span id="125">125</span>
<span id="126">126</span>
<span id="127">127</span>
<span id="128">128</span>
<span id="129">129</span>
<span id="130">130</span>
<span id="131">131</span>
<span id="132">132</span>
<span id="133">133</span>
<span id="134">134</span>
<span id="135">135</span>
<span id="136">136</span>
<span id="137">137</span>
<span id="138">138</span>
<span id="139">139</span>
<span id="140">140</span>
<span id="141">141</span>
<span id="142">142</span>
<span id="143">143</span>
<span id="144">144</span>
<span id="145">145</span>
<span id="146">146</span>
<span id="147">147</span>
<span id="148">148</span>
<span id="149">149</span>
<span id="150">150</span>
<span id="151">151</span>
<span id="152">152</span>
<span id="153">153</span>
<span id="154">154</span>
<span id="155">155</span>
<span id="156">156</span>
<span id="157">157</span>
<span id="158">158</span>
<span id="159">159</span>
<span id="160">160</span>
<span id="161">161</span>
<span id="162">162</span>
<span id="163">163</span>
<span id="164">164</span>
<span id="165">165</span>
<span id="166">166</span>
<span id="167">167</span>
<span id="168">168</span>
<span id="169">169</span>
<span id="170">170</span>
<span id="171">171</span>
<span id="172">172</span>
<span id="173">173</span>
<span id="174">174</span>
<span id="175">175</span>
<span id="176">176</span>
<span id="177">177</span>
<span id="178">178</span>
<span id="179">179</span>
<span id="180">180</span>
<span id="181">181</span>
<span id="182">182</span>
<span id="183">183</span>
<span id="184">184</span>
<span id="185">185</span>
<span id="186">186</span>
<span id="187">187</span>
<span id="188">188</span>
<span id="189">189</span>
<span id="190">190</span>
<span id="191">191</span>
<span id="192">192</span>
<span id="193">193</span>
<span id="194">194</span>
<span id="195">195</span>
<span id="196">196</span>
<span id="197">197</span>
<span id="198">198</span>
<span id="199">199</span>
<span id="200">200</span>
<span id="201">201</span>
<span id="202">202</span>
<span id="203">203</span>
<span id="204">204</span>
<span id="205">205</span>
<span id="206">206</span>
<span id="207">207</span>
<span id="208">208</span>
<span id="209">209</span>
<span id="210">210</span>
<span id="211">211</span>
<span id="212">212</span>
<span id="213">213</span>
<span id="214">214</span>
<span id="215">215</span>
<span id="216">216</span>
<span id="217">217</span>
<span id="218">218</span>
<span id="219">219</span>
<span id="220">220</span>
<span id="221">221</span>
<span id="222">222</span>
<span id="223">223</span>
<span id="224">224</span>
<span id="225">225</span>
<span id="226">226</span>
<span id="227">227</span>
<span id="228">228</span>
<span id="229">229</span>
<span id="230">230</span>
<span id="231">231</span>
<span id="232">232</span>
<span id="233">233</span>
<span id="234">234</span>
<span id="235">235</span>
<span id="236">236</span>
<span id="237">237</span>
<span id="238">238</span>
<span id="239">239</span>
<span id="240">240</span>
<span id="241">241</span>
<span id="242">242</span>
<span id="243">243</span>
<span id="244">244</span>
<span id="245">245</span>
<span id="246">246</span>
<span id="247">247</span>
<span id="248">248</span>
<span id="249">249</span>
<span id="250">250</span>
<span id="251">251</span>
<span id="252">252</span>
<span id="253">253</span>
<span id="254">254</span>
<span id="255">255</span>
<span id="256">256</span>
<span id="257">257</span>
<span id="258">258</span>
<span id="259">259</span>
<span id="260">260</span>
<span id="261">261</span>
<span id="262">262</span>
<span id="263">263</span>
<span id="264">264</span>
<span id="265">265</span>
<span id="266">266</span>
<span id="267">267</span>
<span id="268">268</span>
<span id="269">269</span>
<span id="270">270</span>
<span id="271">271</span>
<span id="272">272</span>
<span id="273">273</span>
<span id="274">274</span>
<span id="275">275</span>
<span id="276">276</span>
<span id="277">277</span>
<span id="278">278</span>
<span id="279">279</span>
<span id="280">280</span>
<span id="281">281</span>
<span id="282">282</span>
<span id="283">283</span>
<span id="284">284</span>
<span id="285">285</span>
<span id="286">286</span>
<span id="287">287</span>
<span id="288">288</span>
<span id="289">289</span>
<span id="290">290</span>
<span id="291">291</span>
<span id="292">292</span>
<span id="293">293</span>
<span id="294">294</span>
<span id="295">295</span>
<span id="296">296</span>
<span id="297">297</span>
<span id="298">298</span>
<span id="299">299</span>
<span id="300">300</span>
<span id="301">301</span>
<span id="302">302</span>
<span id="303">303</span>
<span id="304">304</span>
<span id="305">305</span>
<span id="306">306</span>
<span id="307">307</span>
<span id="308">308</span>
<span id="309">309</span>
<span id="310">310</span>
<span id="311">311</span>
<span id="312">312</span>
<span id="313">313</span>
<span id="314">314</span>
<span id="315">315</span>
<span id="316">316</span>
<span id="317">317</span>
<span id="318">318</span>
<span id="319">319</span>
<span id="320">320</span>
<span id="321">321</span>
<span id="322">322</span>
<span id="323">323</span>
<span id="324">324</span>
<span id="325">325</span>
<span id="326">326</span>
<span id="327">327</span>
<span id="328">328</span>
<span id="329">329</span>
<span id="330">330</span>
<span id="331">331</span>
<span id="332">332</span>
<span id="333">333</span>
<span id="334">334</span>
<span id="335">335</span>
<span id="336">336</span>
<span id="337">337</span>
<span id="338">338</span>
<span id="339">339</span>
<span id="340">340</span>
<span id="341">341</span>
<span id="342">342</span>
<span id="343">343</span>
<span id="344">344</span>
<span id="345">345</span>
<span id="346">346</span>
<span id="347">347</span>
<span id="348">348</span>
<span id="349">349</span>
<span id="350">350</span>
<span id="351">351</span>
<span id="352">352</span>
<span id="353">353</span>
<span id="354">354</span>
<span id="355">355</span>
<span id="356">356</span>
<span id="357">357</span>
<span id="358">358</span>
<span id="359">359</span>
<span id="360">360</span>
<span id="361">361</span>
<span id="362">362</span>
<span id="363">363</span>
<span id="364">364</span>
<span id="365">365</span>
<span id="366">366</span>
<span id="367">367</span>
<span id="368">368</span>
<span id="369">369</span>
<span id="370">370</span>
<span id="371">371</span>
<span id="372">372</span>
<span id="373">373</span>
<span id="374">374</span>
<span id="375">375</span>
<span id="376">376</span>
<span id="377">377</span>
<span id="378">378</span>
<span id="379">379</span>
<span id="380">380</span>
<span id="381">381</span>
<span id="382">382</span>
<span id="383">383</span>
<span id="384">384</span>
<span id="385">385</span>
<span id="386">386</span>
<span id="387">387</span>
<span id="388">388</span>
<span id="389">389</span>
<span id="390">390</span>
<span id="391">391</span>
<span id="392">392</span>
<span id="393">393</span>
<span id="394">394</span>
<span id="395">395</span>
<span id="396">396</span>
<span id="397">397</span>
<span id="398">398</span>
<span id="399">399</span>
<span id="400">400</span>
<span id="401">401</span>
<span id="402">402</span>
<span id="403">403</span>
<span id="404">404</span>
<span id="405">405</span>
<span id="406">406</span>
<span id="407">407</span>
<span id="408">408</span>
<span id="409">409</span>
<span id="410">410</span>
<span id="411">411</span>
<span id="412">412</span>
<span id="413">413</span>
<span id="414">414</span>
<span id="415">415</span>
<span id="416">416</span>
<span id="417">417</span>
<span id="418">418</span>
<span id="419">419</span>
<span id="420">420</span>
<span id="421">421</span>
<span id="422">422</span>
<span id="423">423</span>
<span id="424">424</span>
<span id="425">425</span>
<span id="426">426</span>
<span id="427">427</span>
<span id="428">428</span>
<span id="429">429</span>
<span id="430">430</span>
<span id="431">431</span>
<span id="432">432</span>
<span id="433">433</span>
<span id="434">434</span>
<span id="435">435</span>
<span id="436">436</span>
<span id="437">437</span>
<span id="438">438</span>
<span id="439">439</span>
<span id="440">440</span>
<span id="441">441</span>
<span id="442">442</span>
<span id="443">443</span>
<span id="444">444</span>
<span id="445">445</span>
<span id="446">446</span>
<span id="447">447</span>
<span id="448">448</span>
<span id="449">449</span>
<span id="450">450</span>
<span id="451">451</span>
<span id="452">452</span>
<span id="453">453</span>
<span id="454">454</span>
<span id="455">455</span>
<span id="456">456</span>
<span id="457">457</span>
<span id="458">458</span>
<span id="459">459</span>
<span id="460">460</span>
<span id="461">461</span>
<span id="462">462</span>
<span id="463">463</span>
<span id="464">464</span>
<span id="465">465</span>
<span id="466">466</span>
<span id="467">467</span>
<span id="468">468</span>
<span id="469">469</span>
<span id="470">470</span>
<span id="471">471</span>
<span id="472">472</span>
<span id="473">473</span>
<span id="474">474</span>
<span id="475">475</span>
<span id="476">476</span>
<span id="477">477</span>
<span id="478">478</span>
<span id="479">479</span>
<span id="480">480</span>
<span id="481">481</span>
<span id="482">482</span>
<span id="483">483</span>
<span id="484">484</span>
<span id="485">485</span>
<span id="486">486</span>
<span id="487">487</span>
<span id="488">488</span>
<span id="489">489</span>
<span id="490">490</span>
<span id="491">491</span>
<span id="492">492</span>
<span id="493">493</span>
<span id="494">494</span>
<span id="495">495</span>
<span id="496">496</span>
<span id="497">497</span>
<span id="498">498</span>
<span id="499">499</span>
<span id="500">500</span>
<span id="501">501</span>
<span id="502">502</span>
<span id="503">503</span>
<span id="504">504</span>
<span id="505">505</span>
<span id="506">506</span>
<span id="507">507</span>
<span id="508">508</span>
<span id="509">509</span>
<span id="510">510</span>
<span id="511">511</span>
<span id="512">512</span>
<span id="513">513</span>
<span id="514">514</span>
<span id="515">515</span>
<span id="516">516</span>
<span id="517">517</span>
<span id="518">518</span>
<span id="519">519</span>
<span id="520">520</span>
<span id="521">521</span>
<span id="522">522</span>
<span id="523">523</span>
<span id="524">524</span>
<span id="525">525</span>
<span id="526">526</span>
<span id="527">527</span>
<span id="528">528</span>
<span id="529">529</span>
<span id="530">530</span>
<span id="531">531</span>
<span id="532">532</span>
<span id="533">533</span>
<span id="534">534</span>
<span id="535">535</span>
<span id="536">536</span>
<span id="537">537</span>
<span id="538">538</span>
<span id="539">539</span>
<span id="540">540</span>
<span id="541">541</span>
<span id="542">542</span>
<span id="543">543</span>
<span id="544">544</span>
<span id="545">545</span>
<span id="546">546</span>
<span id="547">547</span>
<span id="548">548</span>
<span id="549">549</span>
<span id="550">550</span>
<span id="551">551</span>
<span id="552">552</span>
<span id="553">553</span>
<span id="554">554</span>
<span id="555">555</span>
<span id="556">556</span>
<span id="557">557</span>
<span id="558">558</span>
<span id="559">559</span>
<span id="560">560</span>
<span id="561">561</span>
<span id="562">562</span>
<span id="563">563</span>
<span id="564">564</span>
<span id="565">565</span>
<span id="566">566</span>
<span id="567">567</span>
<span id="568">568</span>
<span id="569">569</span>
<span id="570">570</span>
<span id="571">571</span>
<span id="572">572</span>
<span id="573">573</span>
<span id="574">574</span>
<span id="575">575</span>
<span id="576">576</span>
<span id="577">577</span>
<span id="578">578</span>
<span id="579">579</span>
<span id="580">580</span>
<span id="581">581</span>
<span id="582">582</span>
<span id="583">583</span>
<span id="584">584</span>
<span id="585">585</span>
<span id="586">586</span>
<span id="587">587</span>
<span id="588">588</span>
<span id="589">589</span>
<span id="590">590</span>
<span id="591">591</span>
<span id="592">592</span>
<span id="593">593</span>
<span id="594">594</span>
<span id="595">595</span>
<span id="596">596</span>
<span id="597">597</span>
<span id="598">598</span>
<span id="599">599</span>
<span id="600">600</span>
<span id="601">601</span>
<span id="602">602</span>
<span id="603">603</span>
<span id="604">604</span>
<span id="605">605</span>
<span id="606">606</span>
<span id="607">607</span>
<span id="608">608</span>
<span id="609">609</span>
<span id="610">610</span>
<span id="611">611</span>
<span id="612">612</span>
<span id="613">613</span>
<span id="614">614</span>
<span id="615">615</span>
<span id="616">616</span>
<span id="617">617</span>
<span id="618">618</span>
<span id="619">619</span>
<span id="620">620</span>
<span id="621">621</span>
<span id="622">622</span>
<span id="623">623</span>
<span id="624">624</span>
<span id="625">625</span>
<span id="626">626</span>
<span id="627">627</span>
<span id="628">628</span>
<span id="629">629</span>
<span id="630">630</span>
<span id="631">631</span>
<span id="632">632</span>
<span id="633">633</span>
<span id="634">634</span>
<span id="635">635</span>
<span id="636">636</span>
<span id="637">637</span>
<span id="638">638</span>
<span id="639">639</span>
<span id="640">640</span>
<span id="641">641</span>
<span id="642">642</span>
<span id="643">643</span>
<span id="644">644</span>
<span id="645">645</span>
<span id="646">646</span>
<span id="647">647</span>
<span id="648">648</span>
<span id="649">649</span>
<span id="650">650</span>
<span id="651">651</span>
<span id="652">652</span>
<span id="653">653</span>
<span id="654">654</span>
<span id="655">655</span>
<span id="656">656</span>
<span id="657">657</span>
<span id="658">658</span>
<span id="659">659</span>
<span id="660">660</span>
<span id="661">661</span>
<span id="662">662</span>
<span id="663">663</span>
<span id="664">664</span>
<span id="665">665</span>
<span id="666">666</span>
<span id="667">667</span>
<span id="668">668</span>
<span id="669">669</span>
<span id="670">670</span>
<span id="671">671</span>
<span id="672">672</span>
<span id="673">673</span>
<span id="674">674</span>
<span id="675">675</span>
<span id="676">676</span>
<span id="677">677</span>
<span id="678">678</span>
<span id="679">679</span>
<span id="680">680</span>
<span id="681">681</span>
<span id="682">682</span>
<span id="683">683</span>
<span id="684">684</span>
<span id="685">685</span>
<span id="686">686</span>
<span id="687">687</span>
<span id="688">688</span>
<span id="689">689</span>
<span id="690">690</span>
<span id="691">691</span>
<span id="692">692</span>
<span id="693">693</span>
<span id="694">694</span>
<span id="695">695</span>
<span id="696">696</span>
<span id="697">697</span>
<span id="698">698</span>
<span id="699">699</span>
<span id="700">700</span>
<span id="701">701</span>
<span id="702">702</span>
<span id="703">703</span>
<span id="704">704</span>
<span id="705">705</span>
<span id="706">706</span>
<span id="707">707</span>
<span id="708">708</span>
<span id="709">709</span>
<span id="710">710</span>
<span id="711">711</span>
<span id="712">712</span>
<span id="713">713</span>
<span id="714">714</span>
<span id="715">715</span>
<span id="716">716</span>
<span id="717">717</span>
<span id="718">718</span>
<span id="719">719</span>
<span id="720">720</span>
<span id="721">721</span>
<span id="722">722</span>
<span id="723">723</span>
<span id="724">724</span>
<span id="725">725</span>
<span id="726">726</span>
<span id="727">727</span>
<span id="728">728</span>
<span id="729">729</span>
<span id="730">730</span>
<span id="731">731</span>
<span id="732">732</span>
<span id="733">733</span>
<span id="734">734</span>
<span id="735">735</span>
<span id="736">736</span>
<span id="737">737</span>
<span id="738">738</span>
<span id="739">739</span>
<span id="740">740</span>
<span id="741">741</span>
<span id="742">742</span>
<span id="743">743</span>
<span id="744">744</span>
<span id="745">745</span>
<span id="746">746</span>
<span id="747">747</span>
<span id="748">748</span>
<span id="749">749</span>
<span id="750">750</span>
<span id="751">751</span>
</pre><pre class='rust '>
<span class='comment'>/*
    Shams: Islamic prayer times and other solar temporal events
    Copyright © 2015  Josh Morin &lt;JoshMorin@gmx.com&gt;

    This program is free software: you can redistribute it and/or 
    modify it under the terms of the GNU Lesser General Public 
    License as published by the Free Software Foundation, either 
    version 3 of the License, or (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Lesser General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.
*/</span>


<span class='comment'>/*
    TODO
        - add correct tempreture value generation to YearIter
            - issue: 
                    At present, the temprature is taken to be 
                    constant through-out the year. This might 
                    be trevial to fix if &quot;good-enough&quot; 
                    approximates are acceptable.
            - posible fixes:
                    Haven&#39;t researched this yet, but there 
                    might be a mathematical model I can use
                    to aproximate the value based on lat, lon,
                    and time of year. This solution will be 
                    best (independant of location).
                    
                    Another solution, if it generates passable
                    values is to store the min and max, then 
                    use a trigometric function with the base as
                    the the delta, and shifted by the minimum.
                    

*/</span>


<span class='doccomment'>//! Islamic prayer times and other solar temporal events</span>
<span class='doccomment'>//!</span>
<span class='doccomment'>//! POSIX Time and UTC</span>
<span class='doccomment'>//! ------------------</span>
<span class='doccomment'>//! This library uses the POSIX/UNIX time system for representing </span>
<span class='doccomment'>//! time. This was chosen to simplify working with timestamps and </span>
<span class='doccomment'>//! durations - for both myself and the user - by deferring the </span>
<span class='doccomment'>//! handling of leap seconds and synchronization with UTC to the host</span>
<span class='doccomment'>//! system.</span>
<span class='doccomment'>//!</span>
<span class='doccomment'>//! For most use cases, the distinction between UTC and POSIX</span>
<span class='doccomment'>//! time is not significant enough to warrant consideration.</span>
<span class='doccomment'>//! </span>
<span class='doccomment'>//!</span>
<span class='doccomment'>//! Extreme Methods</span>
<span class='doccomment'>//! ---------------</span>
<span class='doccomment'>//! In locations towards the north and south poles, the sun may </span>
<span class='doccomment'>//! remain visible multiple days, Extreme methods are the methods </span>
<span class='doccomment'>//! that can be used to approximate (or in some cases, define) </span>
<span class='doccomment'>//! some values returned by this library. Any value that cannot </span>
<span class='doccomment'>//! be calculated in such a situation should return `None`.</span>
<span class='doccomment'>//!</span>
<span class='doccomment'>//! Extreme methods need to be set to take affect.</span>
<span class='doccomment'>//!</span>
<span class='doccomment'>//!</span>
<span class='doccomment'>//! # Copyright #</span>
<span class='doccomment'>//! Copyright © 2015  Josh Morin &lt;JoshMorin@gmx.com&gt;</span>
<span class='doccomment'>//! </span>
<span class='doccomment'>//! This program is free software: you can redistribute it and/or modify</span>
<span class='doccomment'>//! it under the terms of the GNU Lesser General Public License as published by</span>
<span class='doccomment'>//! the Free Software Foundation, either version 3 of the License, or</span>
<span class='doccomment'>//! (at your option) any later version.</span>
<span class='doccomment'>//! </span>
<span class='doccomment'>//! This program is distributed in the hope that it will be useful,</span>
<span class='doccomment'>//! but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class='doccomment'>//! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class='doccomment'>//! GNU Lesser General Public License for more details.</span>
<span class='doccomment'>//! </span>
<span class='doccomment'>//! You should have received a copy of the GNU General Public License</span>
<span class='doccomment'>//! along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>

<span class='kw'>extern</span> <span class='kw'>crate</span> <span class='ident'>time</span>;
<span class='kw'>extern</span> <span class='kw'>crate</span> <span class='ident'>libc</span>;

<span class='kw'>mod</span> <span class='ident'>itl</span>;
<span class='kw'>mod</span> <span class='ident'>db</span>;
<span class='kw'>mod</span> <span class='ident'>date</span>;
<span class='kw'>mod</span> <span class='ident'>tests</span>;

<span class='kw'>pub</span> <span class='kw'>mod</span> <span class='ident'>examples</span>;
<span class='kw'>pub</span> <span class='kw'>use</span> <span class='ident'>date</span>::{<span class='ident'>Date</span>, <span class='ident'>Time</span>, <span class='ident'>Duration</span>};
    
<span class='kw'>use</span> <span class='ident'>libc</span>::<span class='ident'>types</span>::<span class='ident'>os</span>::<span class='ident'>arch</span>::<span class='ident'>c95</span>::{<span class='ident'>c_int</span>, <span class='ident'>c_double</span>};



<span class='doccomment'>/// Environment and Calculation Specification.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// This structure specifies the necessary details for generating</span>
<span class='doccomment'>/// correct times of interest.</span>
<span class='doccomment'>/// </span>
<span class='doccomment'>/// 1. **Environment Details**</span>
<span class='doccomment'>///     1. Latitude and Longitude </span>
<span class='doccomment'>///     2. Elevation</span>
<span class='doccomment'>///     3. Atmospheric Pressure</span>
<span class='doccomment'>///     4. Temperature</span>
<span class='doccomment'>///    </span>
<span class='doccomment'>/// 2. **Time Details**</span>
<span class='doccomment'>///     1. Prayer time Calculation Methods</span>
<span class='doccomment'>///     2. Timezone</span>
<span class='doccomment'>///     3. Date</span>
<span class='doccomment'>///     4. DST state</span>
<span class='doccomment'>/// </span>
<span class='doccomment'>/// 3. **Extended Method Details**</span>
<span class='doccomment'>/// </span>
<span class='doccomment'>/// Unless this structure is populated with all the necessary </span>
<span class='doccomment'>/// information calculations require, calculations will </span>
<span class='doccomment'>/// yield incorrect results. The `new` function does not </span>
<span class='doccomment'>/// initialize the specification to a usable state. Setting</span>
<span class='doccomment'>/// information is done by call the appropriate method.</span>
<span class='doccomment'>/// </span>
<span class='doccomment'>/// ###Extended Details###</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// Atmospheric pressure varies with elevation, location, temperature,</span>
<span class='doccomment'>/// and time of year. For the eastern coast of Arabia, pressure can </span>
<span class='doccomment'>/// range from &lt;`1000` millibars up to around `1020`. The standard </span>
<span class='doccomment'>/// value is `1010.0`.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// Elevation, temperature, location coordinates, Time zone, and DST </span>
<span class='doccomment'>/// can all be determined with a quick web search.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// Which method to use varies from one region to another. If you </span>
<span class='doccomment'>/// don&#39;t care about the correctness of prayer times, you can set </span>
<span class='doccomment'>/// it to 0.</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// [1]: https://commons.wikimedia.org/wiki/File:Mslp-jja-djf.png</span>
<span class='attribute'>#[<span class='ident'>derive</span>(<span class='ident'>Default</span>, <span class='ident'>Clone</span>, <span class='ident'>Copy</span>)]</span>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>ShamsSpec</span> {
    <span class='ident'>method</span>      : <span class='ident'>itl</span>::<span class='ident'>Method</span>,
    <span class='ident'>location</span>    : <span class='ident'>itl</span>::<span class='ident'>Location</span>,
    <span class='ident'>date</span>        : <span class='ident'>itl</span>::<span class='ident'>Date</span>
}
<span class='kw'>impl</span> <span class='ident'>ShamsSpec</span> {
    
    <span class='doccomment'>/// Empty ShamsSpec Object. This object must be converted to </span>
    <span class='doccomment'>/// a ShamsDay object by calling `calculate` or `year` before it </span>
    <span class='doccomment'>/// can be used to infer times.</span>
    <span class='doccomment'>/// </span>
    <span class='doccomment'>/// Converting this object without specifying all the required </span>
    <span class='doccomment'>/// information will yield incorrect results.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>new</span>() <span class='op'>-&gt;</span> <span class='ident'>ShamsSpec</span> {
        <span class='kw'>use</span> <span class='ident'>std</span>::<span class='ident'>default</span>::<span class='ident'>Default</span>;
        <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>s</span>: <span class='ident'>ShamsSpec</span> <span class='op'>=</span> <span class='ident'>Default</span>::<span class='ident'>default</span>();
        <span class='ident'>s</span>.<span class='ident'>method</span>(<span class='number'>0</span>);
        <span class='ident'>s</span>
    }
    
    <span class='doccomment'>/// Attempts to set method, latitude, longitude, elevation, pressure </span>
    <span class='doccomment'>/// and timezone. This deviates from the builder pattern because </span>
    <span class='doccomment'>/// only a small set of cities have these values defined.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// City names may be supplied in Arabic or English. If multiple </span>
    <span class='doccomment'>/// cities with the same name exist, include the name of the </span>
    <span class='doccomment'>/// country. For Example, the strings &quot;Al-Quds&quot;, </span>
    <span class='doccomment'>/// &quot;Al-Quds, Palestine&quot;, &quot;القدس&quot;, and &quot;القدس، فلسطين&quot; are all</span>
    <span class='doccomment'>/// equivalent and will set the same value. </span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// Current cities defined are:</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// 1. Makkah, Saudi Arabia</span>
    <span class='doccomment'>/// 2. Medina, Saudi Arabia</span>
    <span class='doccomment'>/// 3. Al-Quds, Palestine</span>
    <span class='doccomment'>/// 4. Jakarta, Indonesia</span>
    <span class='doccomment'>/// 5. Bandar Seri Begawan, Brunei</span>
    <span class='doccomment'>/// 6. Kuwait, Kuwait</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// If your city is not included in this list, please consider </span>
    <span class='doccomment'>/// taking the time to submit the necessary information to the </span>
    <span class='doccomment'>/// bug tracker. Thank you.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>city</span>(<span class='ident'>name</span>: <span class='kw-2'>&amp;</span><span class='ident'>str</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>ShamsSpec</span><span class='op'>&gt;</span> {
        <span class='kw'>use</span> <span class='ident'>db</span>;
        <span class='kw'>let</span> <span class='ident'>slow</span>: <span class='ident'>Vec</span><span class='op'>&lt;</span><span class='kw-2'>&amp;</span><span class='ident'>str</span><span class='op'>&gt;</span> <span class='op'>=</span> <span class='ident'>name</span>
            .<span class='ident'>split</span>(<span class='op'>|</span><span class='ident'>c</span><span class='op'>|</span> <span class='ident'>c</span> <span class='op'>==</span> <span class='string'>&#39;,&#39;</span> <span class='op'>||</span> <span class='ident'>c</span> <span class='op'>==</span> <span class='string'>&#39; &#39;</span> <span class='op'>||</span> <span class='ident'>c</span> <span class='op'>==</span> <span class='string'>&#39;،&#39;</span>)
            .<span class='ident'>filter</span>(<span class='op'>|</span><span class='ident'>s</span><span class='op'>|</span> <span class='ident'>s</span>.<span class='ident'>len</span>() <span class='op'>!=</span> <span class='number'>0</span>).<span class='ident'>collect</span>();
            
        <span class='kw'>match</span> <span class='ident'>db</span>::<span class='ident'>CITIES</span>.<span class='ident'>iter</span>().<span class='ident'>find</span>(<span class='op'>|</span><span class='ident'>n</span><span class='op'>|</span> <span class='kw-2'>&amp;</span><span class='ident'>n</span>.<span class='number'>0</span>[..<span class='ident'>slow</span>.<span class='ident'>len</span>()] <span class='op'>==</span> <span class='kw-2'>&amp;</span><span class='ident'>slow</span>[..]) {
            <span class='prelude-val'>Some</span>(<span class='ident'>s</span>) <span class='op'>=&gt;</span> {
                <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>d</span> <span class='op'>=</span> <span class='ident'>ShamsSpec</span>::<span class='ident'>new</span>();
                <span class='ident'>d</span>.<span class='ident'>method</span>(<span class='ident'>s</span>.<span class='number'>1</span>.<span class='ident'>method</span>)
                 .<span class='ident'>coordinates</span>(<span class='ident'>s</span>.<span class='number'>1</span>.<span class='ident'>lat</span>, <span class='ident'>s</span>.<span class='number'>1</span>.<span class='ident'>lon</span>)
                 .<span class='ident'>timezone</span>(<span class='ident'>s</span>.<span class='number'>1</span>.<span class='ident'>tz</span>)
                 .<span class='ident'>temperature</span>((<span class='ident'>s</span>.<span class='number'>1</span>.<span class='ident'>temp</span>.<span class='number'>0</span><span class='op'>+</span><span class='ident'>s</span>.<span class='number'>1</span>.<span class='ident'>temp</span>.<span class='number'>1</span>)<span class='op'>/</span><span class='number'>2.0</span>)
                 .<span class='ident'>pressure</span>(<span class='ident'>s</span>.<span class='number'>1</span>.<span class='ident'>pres</span>)
                 .<span class='ident'>elevation</span>(<span class='ident'>s</span>.<span class='number'>1</span>.<span class='ident'>elv</span>);
                <span class='prelude-val'>Some</span>(<span class='ident'>d</span>)
            },
            <span class='prelude-val'>None</span> <span class='op'>=&gt;</span> <span class='prelude-val'>None</span>
        }
        
    }
    
    <span class='doccomment'>/// Sets the method of calculating prayer times.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// Methods can be one of the following:</span>
    <span class='doccomment'>/// </span>
    <span class='doccomment'>/// ```no_test</span>
    <span class='doccomment'>///        0: none. Set to default or 0</span>
    <span class='doccomment'>///        1: Egyptian General Authority of Survey</span>
    <span class='doccomment'>///        2: University of Islamic Sciences, Karachi (Shaf&#39;i)</span>
    <span class='doccomment'>///        3: University of Islamic Sciences, Karachi (Hanafi)</span>
    <span class='doccomment'>///        4: Islamic Society of North America</span>
    <span class='doccomment'>///        5: Muslim World League (MWL)</span>
    <span class='doccomment'>///        6: Umm Al-Qurra, Saudi Arabia</span>
    <span class='doccomment'>///        7: Fixed Ishaa Interval (always 90)</span>
    <span class='doccomment'>///        8: Egyptian General Authority of Survey (Egypt)</span>
    <span class='doccomment'>///        9: Umm Al-Qurra Ramadan, Saudi Arabia</span>
    <span class='doccomment'>///       10: Moonsighting Committee Worldwide</span>
    <span class='doccomment'>///       11: Morocco Awqaf, Morocco</span>
    <span class='doccomment'>/// ```</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>method</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>id</span>: <span class='ident'>u8</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>ShamsSpec</span> {
        <span class='kw'>unsafe</span> {<span class='ident'>itl</span>::<span class='ident'>getMethod</span>(<span class='ident'>id</span> <span class='kw'>as</span> <span class='ident'>c_int</span>, <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>.<span class='ident'>method</span>)};
        <span class='self'>self</span>
    }
    
    <span class='doccomment'>/// Sets latitude and longitude locations.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>coordinates</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>lat</span>: <span class='ident'>f64</span>, <span class='ident'>lon</span>: <span class='ident'>f64</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>ShamsSpec</span> {
        <span class='self'>self</span>.<span class='ident'>location</span>.<span class='ident'>degree_lat</span> <span class='op'>=</span> <span class='ident'>lat</span> <span class='kw'>as</span> <span class='ident'>c_double</span>;
        <span class='self'>self</span>.<span class='ident'>location</span>.<span class='ident'>degree_long</span> <span class='op'>=</span> <span class='ident'>lon</span> <span class='kw'>as</span> <span class='ident'>c_double</span>;
        <span class='self'>self</span>
    }
    
    
    <span class='doccomment'>/// Sets the GMT/UTC offset to `offset`.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// All passed to this object or resulting objects should be </span>
    <span class='doccomment'>/// relative to this offset.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>timezone</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>offset</span>: <span class='ident'>f64</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>ShamsSpec</span> {
        <span class='self'>self</span>.<span class='ident'>location</span>.<span class='ident'>gmt_diff</span> <span class='op'>=</span> <span class='ident'>offset</span>;
        <span class='self'>self</span>
    }
    
    <span class='doccomment'>/// Sets the temperature to `celsius`. Temperature values are in </span>
    <span class='doccomment'>/// Celsius.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>temperature</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>celsius</span>: <span class='ident'>f64</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>ShamsSpec</span> {
        <span class='self'>self</span>.<span class='ident'>location</span>.<span class='ident'>temperature</span> <span class='op'>=</span> <span class='ident'>celsius</span>;
        <span class='self'>self</span>
    }
    
    <span class='doccomment'>/// Sets the atmospheric pressure to `millibar`. Pressure values </span>
    <span class='doccomment'>/// are in millibars.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>pressure</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>millibar</span>: <span class='ident'>f64</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>ShamsSpec</span> {
        <span class='self'>self</span>.<span class='ident'>location</span>.<span class='ident'>pressure</span> <span class='op'>=</span> <span class='ident'>millibar</span>;
        <span class='self'>self</span>
    }

    <span class='doccomment'>/// Sets the elevation to `meters` meters above sea level.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>elevation</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>meters</span>: <span class='ident'>f64</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>ShamsSpec</span> {
        <span class='self'>self</span>.<span class='ident'>location</span>.<span class='ident'>sea_level</span> <span class='op'>=</span> <span class='ident'>meters</span>;
        <span class='self'>self</span>
    }
    
    <span class='doccomment'>/// Sets the state of daylight saving time.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>dst</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>enable</span>: <span class='ident'>bool</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>ShamsSpec</span> {
        <span class='self'>self</span>.<span class='ident'>location</span>.<span class='ident'>dst</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='ident'>enable</span> {<span class='number'>1</span>} <span class='kw'>else</span> {<span class='number'>0</span>};
        <span class='self'>self</span>
    }
    <span class='doccomment'>/// Sets date of interest to today.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>today</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>ShamsSpec</span> {
        <span class='kw'>use</span> <span class='ident'>time</span>;
        <span class='kw'>let</span> <span class='ident'>tm</span> <span class='op'>=</span> <span class='ident'>time</span>::<span class='ident'>now</span>();
        <span class='comment'>// TM is retarded. tm_year starts from 1900, tm_mon starts from 0</span>
        <span class='comment'>// and tm_mday starts from 1 ...</span>
        <span class='comment'>// reminds me of &quot;1&quot;-1 == 0 &amp;&amp; &quot;1&quot;+1 == &quot;11&quot;.</span>
        <span class='self'>self</span>.<span class='ident'>date</span>.<span class='ident'>year</span> <span class='op'>=</span> <span class='ident'>tm</span>.<span class='ident'>tm_year</span><span class='op'>+</span><span class='number'>1900</span>;
        <span class='self'>self</span>.<span class='ident'>date</span>.<span class='ident'>month</span> <span class='op'>=</span> <span class='ident'>tm</span>.<span class='ident'>tm_mon</span><span class='op'>+</span><span class='number'>1</span>;
        <span class='self'>self</span>.<span class='ident'>date</span>.<span class='ident'>day</span> <span class='op'>=</span> <span class='ident'>tm</span>.<span class='ident'>tm_mday</span>;
        
        <span class='self'>self</span>
    }
    <span class='doccomment'>/// Sets the date of interest to the date represented by its </span>
    <span class='doccomment'>/// arguments.</span>
    <span class='doccomment'>/// </span>
    <span class='doccomment'>/// Ranges are inclusive:</span>
    <span class='doccomment'>/// - `day` range is [1, 31]</span>
    <span class='doccomment'>/// - `month` range: [1, 12]</span>
    <span class='doccomment'>/// - `year` is the common 4 digit representation.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>date</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>year</span> :<span class='ident'>u16</span>, <span class='ident'>month</span>: <span class='ident'>u16</span>, <span class='ident'>day</span>: <span class='ident'>u16</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>ShamsSpec</span> {
        <span class='self'>self</span>.<span class='ident'>date</span>.<span class='ident'>year</span> <span class='op'>=</span> <span class='ident'>year</span> <span class='kw'>as</span> <span class='ident'>c_int</span>;
        <span class='self'>self</span>.<span class='ident'>date</span>.<span class='ident'>month</span> <span class='op'>=</span> <span class='ident'>month</span> <span class='kw'>as</span> <span class='ident'>c_int</span>;
        <span class='self'>self</span>.<span class='ident'>date</span>.<span class='ident'>day</span> <span class='op'>=</span> <span class='ident'>day</span> <span class='kw'>as</span> <span class='ident'>c_int</span>;
        
        <span class='self'>self</span>
    
    }
    <span class='doccomment'>/// Sets the date to the date defined by a time stamp. </span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>unix_date</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>ts</span>: <span class='ident'>i64</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>ShamsSpec</span> {
        <span class='kw'>use</span> <span class='ident'>time</span>;
        <span class='kw'>let</span> <span class='ident'>t</span> <span class='op'>=</span> <span class='ident'>time</span>::<span class='ident'>at_utc</span>(<span class='ident'>time</span>::<span class='ident'>Timespec</span>::<span class='ident'>new</span>(<span class='ident'>ts</span>, <span class='number'>0</span>));
        <span class='self'>self</span>.<span class='ident'>date</span>.<span class='ident'>year</span> <span class='op'>=</span> <span class='ident'>t</span>.<span class='ident'>tm_year</span> <span class='op'>+</span> <span class='number'>1900</span> <span class='kw'>as</span> <span class='ident'>c_int</span>;
        <span class='self'>self</span>.<span class='ident'>date</span>.<span class='ident'>month</span> <span class='op'>=</span> <span class='ident'>t</span>.<span class='ident'>tm_mon</span> <span class='op'>+</span> <span class='number'>1</span> <span class='kw'>as</span> <span class='ident'>c_int</span>;
        <span class='self'>self</span>.<span class='ident'>date</span>.<span class='ident'>day</span> <span class='op'>=</span> <span class='ident'>t</span>.<span class='ident'>tm_mday</span> <span class='kw'>as</span> <span class='ident'>c_int</span>;
        <span class='self'>self</span>
    }
    
    
    <span class='doccomment'>/// Sets the Fajr angle in degrees. </span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// This overrides the value defined by a previous call to `method`.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>fajr_angle</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>degrees</span>: <span class='ident'>f64</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>ShamsSpec</span> {
        <span class='self'>self</span>.<span class='ident'>method</span>.<span class='ident'>fajr_ang</span> <span class='op'>=</span> <span class='ident'>degrees</span>;
        <span class='self'>self</span>
    }


    <span class='doccomment'>/// Sets the Isha angle in degrees.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// This overrides the value defined by a previous call to `method`.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>isha_angle</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>degrees</span>: <span class='ident'>f64</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>ShamsSpec</span> {
        <span class='self'>self</span>.<span class='ident'>method</span>.<span class='ident'>ishaa_ang</span> <span class='op'>=</span> <span class='ident'>degrees</span>;
        <span class='self'>self</span>
    }
    
    
    <span class='doccomment'>/// Sets the Fajr interval in minutes between Fajr and Shurooq.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// This overrides the value defined by a previous call to `method`.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>fajr_interval</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>minutes</span>: <span class='ident'>i32</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>ShamsSpec</span> {
        <span class='self'>self</span>.<span class='ident'>method</span>.<span class='ident'>fajr_inv</span> <span class='op'>=</span> <span class='ident'>minutes</span>;
        <span class='self'>self</span>
    }
    
    <span class='doccomment'>/// Sets the Isha interval in minutes between Magrib and Isha</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// This overrides the value defined by a previous call to `method`.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>isha_interval</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>minutes</span>: <span class='ident'>i32</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>ShamsSpec</span> {
        <span class='self'>self</span>.<span class='ident'>method</span>.<span class='ident'>ishaa_inv</span> <span class='op'>=</span> <span class='ident'>minutes</span>;
        <span class='self'>self</span>
    }
    
    <span class='doccomment'>/// Selects the Asr time calculation method; 1: Shafi, 2: Hanafi.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// This overrides the value defined by a previous call to `method`.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>aser_mathhab</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>id</span>: <span class='ident'>i32</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>ShamsSpec</span> {
        <span class='self'>self</span>.<span class='ident'>method</span>.<span class='ident'>mathhab</span> <span class='op'>=</span> <span class='ident'>id</span> <span class='kw'>as</span> <span class='ident'>c_int</span>;
        <span class='self'>self</span>
    }
    
    
    <span class='doccomment'>/// (used for extreme methods: refer to ITL&#39;s documentation)</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>nearest_latitude</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>angle</span> :<span class='ident'>f64</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>ShamsSpec</span> {
        <span class='self'>self</span>.<span class='ident'>method</span>.<span class='ident'>nearest_lat</span> <span class='op'>=</span> <span class='ident'>angle</span>;
        <span class='self'>self</span>
    }
    
    <span class='doccomment'>/// (used for extreme methods: refer to ITL&#39;s documentation)</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>extreme</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>, <span class='ident'>extreme</span> :<span class='ident'>i32</span>) <span class='op'>-&gt;</span> <span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='ident'>ShamsSpec</span> {
        <span class='self'>self</span>.<span class='ident'>method</span>.<span class='ident'>extreme</span> <span class='op'>=</span> <span class='ident'>extreme</span> <span class='kw'>as</span> <span class='ident'>c_int</span>;
        <span class='self'>self</span>
    }
    
    <span class='doccomment'>/// Calculates the times of interest based on the supplied </span>
    <span class='doccomment'>/// information. The specification object can be reused post</span>
    <span class='doccomment'>/// calculation.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>calculate</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Result</span><span class='op'>&lt;</span><span class='ident'>ShamsDay</span>, <span class='ident'>String</span><span class='op'>&gt;</span> {
        <span class='kw'>use</span> ::<span class='ident'>date</span>::{<span class='ident'>uts</span>, <span class='ident'>month_list</span>};
        
        <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>buf</span>: [<span class='ident'>itl</span>::<span class='ident'>Prayer</span>; <span class='number'>6</span>] <span class='op'>=</span> [<span class='ident'>Default</span>::<span class='ident'>default</span>(); <span class='number'>6</span>];
        <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>config</span> <span class='op'>=</span> <span class='self'>self</span>.<span class='ident'>clone</span>();
        
        
        <span class='comment'>// Validation</span>
        <span class='kw'>if</span> <span class='ident'>config</span>.<span class='ident'>date</span>.<span class='ident'>year</span> <span class='op'>&lt;</span> <span class='number'>1970</span> {
            <span class='kw'>return</span> <span class='prelude-val'>Err</span>(<span class='macro'>format</span><span class='macro'>!</span>(<span class='macro'>concat</span><span class='macro'>!</span>(<span class='string'>&quot;Minimum year supported is 1970: &quot;</span>,
                    <span class='string'>&quot;supplied year is {}.&quot;</span>), <span class='ident'>config</span>.<span class='ident'>date</span>.<span class='ident'>year</span>));
        }
        <span class='kw'>if</span> <span class='ident'>config</span>.<span class='ident'>date</span>.<span class='ident'>month</span> <span class='op'>&lt;</span> <span class='number'>1</span> <span class='op'>||</span> <span class='ident'>config</span>.<span class='ident'>date</span>.<span class='ident'>month</span> <span class='op'>&gt;</span> <span class='number'>12</span> {
            <span class='kw'>return</span> <span class='prelude-val'>Err</span>(<span class='macro'>format</span><span class='macro'>!</span>(<span class='macro'>concat</span><span class='macro'>!</span>(<span class='string'>&quot;Invalid month specified: valid &quot;</span>,
                    <span class='string'>&quot;month is in the range of [1, 12]. supplied &quot;</span>,
                    <span class='string'>&quot;month is {}.&quot;</span>), <span class='ident'>config</span>.<span class='ident'>date</span>.<span class='ident'>month</span>));
        }
        <span class='kw'>if</span> <span class='ident'>config</span>.<span class='ident'>date</span>.<span class='ident'>day</span> <span class='op'>&lt;</span> <span class='number'>1</span> <span class='op'>||</span>
           <span class='ident'>config</span>.<span class='ident'>date</span>.<span class='ident'>day</span> <span class='kw'>as</span> <span class='ident'>u16</span> <span class='op'>&gt;</span> <span class='ident'>month_list</span>(<span class='ident'>config</span>.<span class='ident'>date</span>.<span class='ident'>year</span> <span class='kw'>as</span> <span class='ident'>u16</span>)[<span class='ident'>config</span>.<span class='ident'>date</span>.<span class='ident'>month</span> <span class='kw'>as</span> <span class='ident'>usize</span> <span class='op'>-</span> <span class='number'>1</span>] {
            <span class='kw'>return</span> <span class='prelude-val'>Err</span>(<span class='macro'>format</span><span class='macro'>!</span>(<span class='macro'>concat</span><span class='macro'>!</span>(<span class='string'>&quot;Invalid date specified for month &quot;</span>,
                    <span class='string'>&quot;{}: valid day is in the range of [1, {}]. supplied &quot;</span>,
                    <span class='string'>&quot;day is {}.&quot;</span>), <span class='ident'>config</span>.<span class='ident'>date</span>.<span class='ident'>month</span>, 
                    <span class='ident'>month_list</span>(<span class='ident'>config</span>.<span class='ident'>date</span>.<span class='ident'>year</span> <span class='kw'>as</span> <span class='ident'>u16</span>)[<span class='ident'>config</span>.<span class='ident'>date</span>.<span class='ident'>month</span> <span class='kw'>as</span> <span class='ident'>usize</span> <span class='op'>-</span> <span class='number'>1</span>],
                    <span class='ident'>config</span>.<span class='ident'>date</span>.<span class='ident'>day</span>));
        
        }
        
        <span class='kw'>if</span> <span class='op'>!</span>(<span class='ident'>config</span>.<span class='ident'>location</span>.<span class='ident'>degree_lat</span> <span class='op'>&gt;=</span> <span class='op'>-</span><span class='number'>90.000001</span> <span class='op'>&amp;&amp;</span> <span class='ident'>config</span>.<span class='ident'>location</span>.<span class='ident'>degree_lat</span> <span class='op'>&lt;=</span> <span class='number'>90.000001</span>) {
            <span class='kw'>return</span> <span class='prelude-val'>Err</span>(<span class='macro'>format</span><span class='macro'>!</span>(<span class='macro'>concat</span><span class='macro'>!</span>(<span class='string'>&quot;Invalid latitude specified: valid &quot;</span>,
                    <span class='string'>&quot;latitude is in the range of [-90.0, 90.0]. supplied &quot;</span>,
                    <span class='string'>&quot;month is {}.&quot;</span>), <span class='ident'>config</span>.<span class='ident'>location</span>.<span class='ident'>degree_lat</span>));
        }
        
        <span class='kw'>if</span> <span class='op'>!</span>(<span class='ident'>config</span>.<span class='ident'>location</span>.<span class='ident'>degree_long</span> <span class='op'>&gt;=</span> <span class='op'>-</span><span class='number'>180.000001</span> <span class='op'>&amp;&amp;</span> <span class='ident'>config</span>.<span class='ident'>location</span>.<span class='ident'>degree_long</span> <span class='op'>&lt;=</span> <span class='number'>180.000001</span>) {
            <span class='kw'>return</span> <span class='prelude-val'>Err</span>(<span class='macro'>format</span><span class='macro'>!</span>(<span class='macro'>concat</span><span class='macro'>!</span>(<span class='string'>&quot;Invalid longitude specified: valid &quot;</span>,
                    <span class='string'>&quot;longitude is in the range of [-180.0, 180.0]. supplied &quot;</span>,
                    <span class='string'>&quot;month is {}.&quot;</span>), <span class='ident'>config</span>.<span class='ident'>location</span>.<span class='ident'>degree_long</span>));
        }
        
        <span class='kw'>if</span> <span class='ident'>config</span>.<span class='ident'>method</span>.<span class='ident'>method</span> <span class='op'>&gt;</span> <span class='number'>11</span> {
            <span class='kw'>return</span> <span class='prelude-val'>Err</span>(<span class='macro'>format</span><span class='macro'>!</span>(<span class='macro'>concat</span><span class='macro'>!</span>(<span class='string'>&quot;Invalid method specified: valid &quot;</span>,
                    <span class='string'>&quot;method is in the range of [0, 11]. supplied &quot;</span>,
                    <span class='string'>&quot;month is {}.&quot;</span>), <span class='ident'>config</span>.<span class='ident'>method</span>.<span class='ident'>method</span>));
        }

        <span class='kw'>if</span> <span class='op'>!</span>(<span class='ident'>config</span>.<span class='ident'>location</span>.<span class='ident'>gmt_diff</span> <span class='op'>&gt;=</span> <span class='op'>-</span><span class='number'>12.000001</span> <span class='op'>&amp;&amp;</span> <span class='ident'>config</span>.<span class='ident'>location</span>.<span class='ident'>gmt_diff</span> <span class='op'>&lt;=</span> <span class='number'>14.000001</span>) {
            <span class='kw'>return</span> <span class='prelude-val'>Err</span>(<span class='macro'>format</span><span class='macro'>!</span>(<span class='macro'>concat</span><span class='macro'>!</span>(<span class='string'>&quot;Invalid time zone specified: valid &quot;</span>,
                    <span class='string'>&quot;method is in the range of UTC-12, UTC+14]. supplied &quot;</span>,
                    <span class='string'>&quot;month is {}.&quot;</span>), <span class='ident'>config</span>.<span class='ident'>location</span>.<span class='ident'>gmt_diff</span>));
        }
        

        <span class='comment'>// convert Prayer time -&gt; Option&lt;timestamp&gt;, extreme</span>
        <span class='macro'>macro_rules</span><span class='macro'>!</span> <span class='ident'>fill</span> {
            (<span class='macro-nonterminal'>$</span><span class='macro-nonterminal'>i</span>: <span class='ident'>expr</span>) <span class='op'>=&gt;</span> (
                <span class='kw'>if</span> <span class='ident'>buf</span>[<span class='macro-nonterminal'>$</span><span class='macro-nonterminal'>i</span>].<span class='ident'>hour</span> <span class='op'>==</span> <span class='number'>99</span> <span class='op'>||</span> <span class='ident'>buf</span>[<span class='macro-nonterminal'>$</span><span class='macro-nonterminal'>i</span>].<span class='ident'>minute</span> <span class='op'>==</span> <span class='number'>99</span> {(<span class='prelude-val'>None</span>, <span class='boolval'>false</span>)}
                <span class='kw'>else</span> {
                    (<span class='prelude-val'>Some</span>(<span class='ident'>Time</span>(<span class='ident'>uts</span>(
                                <span class='ident'>config</span>.<span class='ident'>date</span>.<span class='ident'>year</span> <span class='kw'>as</span> <span class='ident'>u16</span>, <span class='ident'>config</span>.<span class='ident'>date</span>.<span class='ident'>month</span> <span class='kw'>as</span> <span class='ident'>u16</span>, 
                                <span class='ident'>config</span>.<span class='ident'>date</span>.<span class='ident'>day</span> <span class='kw'>as</span> <span class='ident'>u16</span>, <span class='ident'>buf</span>[<span class='macro-nonterminal'>$</span><span class='macro-nonterminal'>i</span>].<span class='ident'>hour</span> <span class='kw'>as</span> <span class='ident'>u16</span>, 
                                <span class='ident'>buf</span>[<span class='macro-nonterminal'>$</span><span class='macro-nonterminal'>i</span>].<span class='ident'>minute</span>  <span class='kw'>as</span> <span class='ident'>u16</span>, <span class='ident'>buf</span>[<span class='macro-nonterminal'>$</span><span class='macro-nonterminal'>i</span>].<span class='ident'>second</span> <span class='kw'>as</span> <span class='ident'>u16</span>))), 
                                <span class='ident'>buf</span>[<span class='macro-nonterminal'>$</span><span class='macro-nonterminal'>i</span>].<span class='ident'>is_extreme</span> <span class='op'>!=</span> <span class='number'>0</span>)}
            )
        }
        
        <span class='comment'>// fill current day with prayer times for the specified date</span>
        <span class='kw'>unsafe</span> {<span class='ident'>itl</span>::<span class='ident'>getPrayerTimes</span>(<span class='kw-2'>&amp;</span><span class='ident'>config</span>.<span class='ident'>location</span>, <span class='kw-2'>&amp;</span><span class='ident'>config</span>.<span class='ident'>method</span>, <span class='kw-2'>&amp;</span><span class='ident'>config</span>.<span class='ident'>date</span>, <span class='ident'>buf</span>.<span class='ident'>as_mut_ptr</span>())};
        <span class='kw'>let</span> <span class='ident'>current_day</span> <span class='op'>=</span> [<span class='macro'>fill</span><span class='macro'>!</span>(<span class='number'>0</span>), <span class='macro'>fill</span><span class='macro'>!</span>(<span class='number'>1</span>), 
                          <span class='macro'>fill</span><span class='macro'>!</span>(<span class='number'>2</span>), <span class='macro'>fill</span><span class='macro'>!</span>(<span class='number'>3</span>), 
                          <span class='macro'>fill</span><span class='macro'>!</span>(<span class='number'>4</span>), <span class='macro'>fill</span><span class='macro'>!</span>(<span class='number'>5</span>)];

        <span class='comment'>// jump to the next date by adding 24 hours to the current day, </span>
        <span class='comment'>// then fill next_day with prayertime</span>
        <span class='kw'>let</span> <span class='ident'>next_day</span> <span class='op'>=</span> {
            <span class='comment'>// satisfying rust&#39;s borrow checker</span>
            <span class='kw'>let</span> <span class='ident'>year</span> <span class='op'>=</span> <span class='ident'>config</span>.<span class='ident'>date</span>.<span class='ident'>year</span> <span class='kw'>as</span> <span class='ident'>u16</span>;
            <span class='kw'>let</span> <span class='ident'>month</span> <span class='op'>=</span> <span class='ident'>config</span>.<span class='ident'>date</span>.<span class='ident'>month</span> <span class='kw'>as</span> <span class='ident'>u16</span>;
            <span class='kw'>let</span> <span class='ident'>day</span> <span class='op'>=</span> <span class='ident'>config</span>.<span class='ident'>date</span>.<span class='ident'>day</span> <span class='kw'>as</span> <span class='ident'>u16</span>;
            
            <span class='ident'>config</span>.<span class='ident'>unix_date</span>(<span class='ident'>uts</span>(<span class='ident'>year</span>, <span class='ident'>month</span>, <span class='ident'>day</span>, <span class='number'>1</span>, <span class='number'>0</span>, <span class='number'>0</span>)<span class='op'>+</span><span class='number'>24</span><span class='op'>*</span><span class='number'>3600</span>);
            
            <span class='kw'>unsafe</span> {<span class='ident'>itl</span>::<span class='ident'>getPrayerTimes</span>(<span class='kw-2'>&amp;</span><span class='ident'>config</span>.<span class='ident'>location</span>, <span class='kw-2'>&amp;</span><span class='ident'>config</span>.<span class='ident'>method</span>, <span class='kw-2'>&amp;</span><span class='ident'>config</span>.<span class='ident'>date</span>, <span class='ident'>buf</span>.<span class='ident'>as_mut_ptr</span>())};
            
            [<span class='macro'>fill</span><span class='macro'>!</span>(<span class='number'>0</span>), <span class='macro'>fill</span><span class='macro'>!</span>(<span class='number'>1</span>), <span class='macro'>fill</span><span class='macro'>!</span>(<span class='number'>2</span>), <span class='macro'>fill</span><span class='macro'>!</span>(<span class='number'>3</span>), <span class='macro'>fill</span><span class='macro'>!</span>(<span class='number'>4</span>), <span class='macro'>fill</span><span class='macro'>!</span>(<span class='number'>5</span>)]
        };
        
        <span class='prelude-val'>Ok</span>(<span class='ident'>ShamsDay</span> {
            <span class='ident'>date</span>: <span class='ident'>Date</span> {<span class='ident'>year</span>    : <span class='self'>self</span>.<span class='ident'>date</span>.<span class='ident'>year</span> <span class='kw'>as</span> <span class='ident'>u16</span>, 
                        <span class='ident'>month</span>   : <span class='self'>self</span>.<span class='ident'>date</span>.<span class='ident'>month</span> <span class='kw'>as</span> <span class='ident'>u16</span>, 
                        <span class='ident'>day</span>     : <span class='self'>self</span>.<span class='ident'>date</span>.<span class='ident'>day</span> <span class='kw'>as</span> <span class='ident'>u16</span>},
            <span class='ident'>current</span>: <span class='ident'>current_day</span>,
            <span class='ident'>next</span>: <span class='ident'>next_day</span>
        })
    }
    
    <span class='doccomment'>/// Returns an iterator that produces a ShamsDay for each day </span>
    <span class='doccomment'>/// of the specified year.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>year</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>, <span class='ident'>year</span>: <span class='ident'>u16</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Result</span><span class='op'>&lt;</span><span class='ident'>YearIter</span>, <span class='ident'>String</span><span class='op'>&gt;</span> {
        <span class='ident'>YearIter</span>::<span class='ident'>new</span>(<span class='self'>self</span>, <span class='ident'>year</span>)
    }
}


<span class='doccomment'>/// A Collection of times of interest for a specific date</span>
<span class='doccomment'>///</span>
<span class='doccomment'>/// Some methods will use `Extreme Methods` to preform the required </span>
<span class='doccomment'>/// calculates if configured to do so. See the `Extreme Methods` </span>
<span class='doccomment'>/// section in the top level of the documentation for a description </span>
<span class='doccomment'>/// of what extreme methods are and what they entail.</span>
<span class='attribute'>#[<span class='ident'>derive</span>(<span class='ident'>Clone</span>, <span class='ident'>Copy</span>)]</span>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>ShamsDay</span> {
    <span class='ident'>date</span>        : <span class='ident'>Date</span>,
    <span class='ident'>current</span>     : [(<span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>Time</span><span class='op'>&gt;</span>, <span class='ident'>bool</span>); <span class='number'>6</span>],
    <span class='ident'>next</span>        : [(<span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>Time</span><span class='op'>&gt;</span>, <span class='ident'>bool</span>); <span class='number'>6</span>]
}
<span class='kw'>impl</span> <span class='ident'>ShamsDay</span> {
    
    <span class='doccomment'>/// Returns the date for which the results in this object apply.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>date</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='ident'>Date</span> {
        <span class='self'>self</span>.<span class='ident'>date</span>
    }
    
    <span class='doccomment'>/// Time of Fajr prayer if calculable and a flag to </span>
    <span class='doccomment'>/// signal if the time was calculated using extreme methods.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>fajr</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>Time</span><span class='op'>&gt;</span>, <span class='ident'>bool</span>) {
        <span class='self'>self</span>.<span class='ident'>current</span>[<span class='number'>0</span>]
    }
    <span class='doccomment'>/// Time of next-day Fajr prayer if calculable and a </span>
    <span class='doccomment'>/// flag to signal if the time was calculated using extreme </span>
    <span class='doccomment'>/// methods.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>next_fajr</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>Time</span><span class='op'>&gt;</span>, <span class='ident'>bool</span>) {
        <span class='self'>self</span>.<span class='ident'>next</span>[<span class='number'>0</span>]
    }
    <span class='doccomment'>/// Time of Shurooq prayer if calculable and a flag to </span>
    <span class='doccomment'>/// signal if the time was calculated using extreme methods.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>shurooq</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>Time</span><span class='op'>&gt;</span>, <span class='ident'>bool</span>) {
        <span class='self'>self</span>.<span class='ident'>current</span>[<span class='number'>1</span>]
    }
    <span class='doccomment'>/// Time of next-day Shurooq prayer if calculable and </span>
    <span class='doccomment'>/// a flag to signal if the time was calculated using extreme </span>
    <span class='doccomment'>/// methods.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>next_shurooq</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>Time</span><span class='op'>&gt;</span>, <span class='ident'>bool</span>) {
        <span class='self'>self</span>.<span class='ident'>next</span>[<span class='number'>1</span>]
    }
    <span class='doccomment'>/// Time of Zuhr prayer if calculable and a flag to </span>
    <span class='doccomment'>/// signal if the time was calculated using extreme methods.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>zuhr</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>Time</span><span class='op'>&gt;</span>, <span class='ident'>bool</span>) {
        <span class='self'>self</span>.<span class='ident'>current</span>[<span class='number'>2</span>]
    }
    <span class='doccomment'>/// Time of Asr prayer if calculable and a flag to </span>
    <span class='doccomment'>/// signal if the time was calculated using extreme methods.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>asr</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>Time</span><span class='op'>&gt;</span>, <span class='ident'>bool</span>) {
        <span class='self'>self</span>.<span class='ident'>current</span>[<span class='number'>3</span>]
    }
    <span class='doccomment'>/// Time of Maghrib prayer if calculable and a flag to </span>
    <span class='doccomment'>/// signal if the time was calculated using extreme methods.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>maghrib</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>Time</span><span class='op'>&gt;</span>, <span class='ident'>bool</span>) {
        <span class='self'>self</span>.<span class='ident'>current</span>[<span class='number'>4</span>]
    }
    <span class='doccomment'>/// Time of Isha prayer if calculable and a flag to </span>
    <span class='doccomment'>/// signal if the time was calculated using extreme methods.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>isha</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> (<span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>Time</span><span class='op'>&gt;</span>, <span class='ident'>bool</span>) {
        <span class='self'>self</span>.<span class='ident'>current</span>[<span class='number'>5</span>]
    }
    <span class='doccomment'>/// Time of Sunrise.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// Returns `None` if this value can not be reliably calculated.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>sunrise</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>Time</span><span class='op'>&gt;</span> {
        <span class='kw'>let</span> (<span class='ident'>t</span>, <span class='ident'>e</span>) <span class='op'>=</span> <span class='self'>self</span>.<span class='ident'>shurooq</span>();
        <span class='kw'>if</span> <span class='ident'>e</span> {<span class='kw'>return</span> <span class='prelude-val'>None</span>;}
        <span class='ident'>t</span>
    }
    
    <span class='doccomment'>/// Time of next-day sunrise.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// Returns `None` if this value can not be reliably calculated.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>next_sunrise</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>Time</span><span class='op'>&gt;</span> {
        <span class='kw'>let</span> (<span class='ident'>t</span>, <span class='ident'>e</span>) <span class='op'>=</span> <span class='self'>self</span>.<span class='ident'>next_shurooq</span>();
        <span class='kw'>if</span> <span class='ident'>e</span> {<span class='kw'>return</span> <span class='prelude-val'>None</span>;}
        <span class='ident'>t</span>
    }
    
    <span class='doccomment'>/// Time of Sunset.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// Returns `None` if this value can not be reliably calculated.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>sunset</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>Time</span><span class='op'>&gt;</span> {
        <span class='kw'>let</span> (<span class='ident'>t</span>, <span class='ident'>e</span>) <span class='op'>=</span> <span class='self'>self</span>.<span class='ident'>maghrib</span>();
        <span class='kw'>if</span> <span class='ident'>e</span> {<span class='kw'>return</span> <span class='prelude-val'>None</span>;}
        <span class='ident'>t</span>
    }
    
    <span class='doccomment'>/// Duration (no leap seconds) of daytime in seconds:</span>
    <span class='doccomment'>/// The time between sunrise and sunset.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// Returns `None` if this value can not be reliably calculated.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>daytime</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>Duration</span><span class='op'>&gt;</span> {
        <span class='kw'>if</span> <span class='kw'>let</span> (<span class='prelude-val'>Some</span>(<span class='ident'>Time</span>(<span class='ident'>sr</span>)), <span class='prelude-val'>Some</span>(<span class='ident'>Time</span>(<span class='ident'>ss</span>))) <span class='op'>=</span> (<span class='self'>self</span>.<span class='ident'>sunrise</span>(), <span class='self'>self</span>.<span class='ident'>sunset</span>()) {
            <span class='prelude-val'>Some</span>(<span class='ident'>Duration</span>(<span class='ident'>ss</span> <span class='op'>-</span> <span class='ident'>sr</span>))
        }
        <span class='kw'>else</span> {
            <span class='prelude-val'>None</span>
        }
    }
    
    <span class='doccomment'>/// Dur ration (no leap seconds) of nighttime in seconds:</span>
    <span class='doccomment'>/// The time between sunset and sunrise.</span>
    <span class='doccomment'>/// </span>
    <span class='doccomment'>/// Returns `None` if this value can not be reliably calculated.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>nighttime</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>Duration</span><span class='op'>&gt;</span> {
        <span class='kw'>if</span> <span class='kw'>let</span> (<span class='prelude-val'>Some</span>(<span class='ident'>Time</span>(<span class='ident'>ss</span>)), <span class='prelude-val'>Some</span>(<span class='ident'>Time</span>(<span class='ident'>nsr</span>))) <span class='op'>=</span> (<span class='self'>self</span>.<span class='ident'>sunset</span>(), <span class='self'>self</span>.<span class='ident'>next_sunrise</span>()) {
            <span class='prelude-val'>Some</span>(<span class='ident'>Duration</span>(<span class='ident'>nsr</span> <span class='op'>-</span> <span class='ident'>ss</span>))
        }
        <span class='kw'>else</span> {
            <span class='prelude-val'>None</span>
        }
    }
    
    
    <span class='doccomment'>/// Returns POSIX time of midday; between sunrise and sunset.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// Returns `None` if this value can not be reliably calculated.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>noon</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>Time</span><span class='op'>&gt;</span> {
        <span class='kw'>if</span> <span class='kw'>let</span> (<span class='prelude-val'>Some</span>(<span class='ident'>Duration</span>(<span class='ident'>d</span>)), <span class='prelude-val'>Some</span>(<span class='ident'>Time</span>(<span class='ident'>sr</span>))) <span class='op'>=</span> (<span class='self'>self</span>.<span class='ident'>daytime</span>(), <span class='self'>self</span>.<span class='ident'>sunrise</span>()) {
            <span class='prelude-val'>Some</span>(<span class='ident'>Time</span>(<span class='ident'>sr</span> <span class='op'>+</span> <span class='ident'>d</span><span class='op'>/</span><span class='number'>2</span>))
        }
        <span class='kw'>else</span> {
            <span class='prelude-val'>None</span>
        }
    }
    
    
    <span class='doccomment'>/// Returns the midpoint between sunset and sunrise.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// Returns `None` if this value can not be reliably calculated.</span>
    <span class='doccomment'>/// </span>
    <span class='doccomment'>/// Note that this value does not represent the end of</span>
    <span class='doccomment'>/// the Isha time if it ends at &quot;midnight&quot;. In Islam, </span>
    <span class='doccomment'>/// daytime starts at dusk, rather than sunrise.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>midnight</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>Time</span><span class='op'>&gt;</span> {
        <span class='kw'>if</span> <span class='kw'>let</span> (<span class='prelude-val'>Some</span>(<span class='ident'>Duration</span>(<span class='ident'>n</span>)), <span class='prelude-val'>Some</span>(<span class='ident'>Time</span>(<span class='ident'>ss</span>))) <span class='op'>=</span> (<span class='self'>self</span>.<span class='ident'>nighttime</span>(), <span class='self'>self</span>.<span class='ident'>sunset</span>()) {
            <span class='prelude-val'>Some</span>(<span class='ident'>Time</span>(<span class='ident'>ss</span> <span class='op'>+</span> <span class='ident'>n</span><span class='op'>/</span><span class='number'>2</span>))
        }
        <span class='kw'>else</span> {
            <span class='prelude-val'>None</span>
        }
    }
    
    <span class='doccomment'>/// Returns a time at which the sun would be perceived to be at</span>
    <span class='doccomment'>/// `angle` with the location from which it rose.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// The times this function returns correspond to what humans </span>
    <span class='doccomment'>/// would perceive as the reasonable values.</span>
    <span class='doccomment'>/// </span>
    <span class='doccomment'>/// To maintain perception accuracy, `angle` does not linearly </span>
    <span class='doccomment'>/// correlate with time or relative location of the sun.</span>
    <span class='doccomment'>/// See `phase_time`.</span>
    <span class='doccomment'>/// </span>
    <span class='doccomment'>/// Also, the time at `angle` 0.0 does not necessarily equate to </span>
    <span class='doccomment'>/// that of 60.0. Angles 0.0 and 360.0 correspond to the sunrises </span>
    <span class='doccomment'>/// of the current day and the day the follows it, respectively.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// Angle values must be between 0.0 and 360.0. if this is </span>
    <span class='doccomment'>/// not the case, angle will be clipped to those boundaries.</span>
    <span class='doccomment'>/// </span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>angle_time</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>, <span class='ident'>angle</span>: <span class='ident'>f64</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>Time</span><span class='op'>&gt;</span> {
        <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>phase</span> <span class='op'>=</span> <span class='ident'>angle</span>;
        <span class='kw'>if</span> <span class='ident'>phase</span> <span class='op'>&lt;</span> <span class='number'>0.0</span> { <span class='ident'>phase</span> <span class='op'>=</span> <span class='number'>0.0</span> }
        <span class='kw'>if</span> <span class='ident'>phase</span> <span class='op'>&gt;</span> <span class='number'>360.0</span> { <span class='ident'>phase</span> <span class='op'>=</span> <span class='number'>360.0</span> }
        <span class='ident'>phase</span> <span class='op'>/=</span> <span class='number'>180.0</span>;
        
        <span class='self'>self</span>.<span class='ident'>phase_time</span>(<span class='ident'>phase</span>)
    }
    
    <span class='doccomment'>/// Returns the POSIX time when the sun is at a phase defined in the</span>
    <span class='doccomment'>/// table bellow:</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// - Normalized phase of `0.0` implies sunrise.</span>
    <span class='doccomment'>/// - Normalized phase of `0.5` implies noon.</span>
    <span class='doccomment'>/// - Normalized phase of `1.0` implies sunset.</span>
    <span class='doccomment'>/// - Normalized phase of `1.5` implies midnight.</span>
    <span class='doccomment'>/// - Normalized phase of `2.0` implies the sunrise of the next day</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// Phase value must be between 0.0 and 2.0, inclusive. If this isn&#39;t</span>
    <span class='doccomment'>/// the case, `phase` will be clipped to the nearest boundary.</span>
    <span class='doccomment'>///</span>
    <span class='doccomment'>/// Note: The phase value does not linearly correlate with the sun&#39;s </span>
    <span class='doccomment'>/// actual angle (time of day); the duration between 0.0 and 1.0 will </span>
    <span class='doccomment'>/// likely be different than the duration between 1.0 and 2.0, </span>
    <span class='doccomment'>/// depending on the location and time of year.</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>phase_time</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>, <span class='ident'>phase</span>: <span class='ident'>f64</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>Time</span><span class='op'>&gt;</span> {
        <span class='kw'>let</span> <span class='kw-2'>mut</span> <span class='ident'>phase</span> <span class='op'>=</span> <span class='ident'>phase</span>;
        <span class='kw'>if</span> <span class='ident'>phase</span> <span class='op'>&lt;</span> <span class='number'>0.0</span> {
            <span class='ident'>phase</span> <span class='op'>=</span> <span class='number'>0.0</span>;
        }
        <span class='kw'>if</span> <span class='ident'>phase</span> <span class='op'>&gt;</span> <span class='number'>2.0</span> {
            <span class='ident'>phase</span> <span class='op'>=</span> <span class='number'>2.0</span>;
        }
        <span class='kw'>if</span> <span class='kw'>let</span> (<span class='prelude-val'>Some</span>(<span class='ident'>Duration</span>(<span class='ident'>daytime</span>)), <span class='prelude-val'>Some</span>(<span class='ident'>Duration</span>(<span class='ident'>nighttime</span>)), <span class='prelude-val'>Some</span>(<span class='ident'>Time</span>(<span class='ident'>sunrise</span>))) <span class='op'>=</span> 
                                                  (<span class='self'>self</span>.<span class='ident'>daytime</span>(), <span class='self'>self</span>.<span class='ident'>nighttime</span>(), <span class='self'>self</span>.<span class='ident'>sunrise</span>()) {
            <span class='kw'>if</span> <span class='ident'>phase</span> <span class='op'>&lt;=</span> <span class='number'>1.0</span> {
                <span class='prelude-val'>Some</span>(<span class='ident'>Time</span>(
                    <span class='ident'>sunrise</span> <span class='op'>+</span> ((<span class='ident'>daytime</span> <span class='kw'>as</span> <span class='ident'>f64</span>) <span class='op'>*</span> <span class='ident'>phase</span>) <span class='kw'>as</span> <span class='ident'>i64</span>
                ))
            }
            <span class='kw'>else</span> {
                <span class='prelude-val'>Some</span>(<span class='ident'>Time</span>(
                    <span class='ident'>sunrise</span> <span class='op'>+</span> <span class='ident'>daytime</span> <span class='op'>+</span> ((<span class='ident'>nighttime</span> <span class='kw'>as</span> <span class='ident'>f64</span>) <span class='op'>*</span> (<span class='ident'>phase</span> <span class='op'>-</span> <span class='number'>1.0</span>)) <span class='kw'>as</span> <span class='ident'>i64</span>
                ))
            }
        }
        <span class='kw'>else</span> {
            <span class='prelude-val'>None</span>
        }
    }
    <span class='comment'>// copy to Spec for a general on the spot generation?</span>
    <span class='kw'>pub</span> <span class='kw'>fn</span> <span class='ident'>time_phase</span>(<span class='kw-2'>&amp;</span><span class='self'>self</span>, <span class='ident'>time</span>: <span class='ident'>Time</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>f64</span><span class='op'>&gt;</span> {
        <span class='kw'>if</span> <span class='kw'>let</span> (<span class='prelude-val'>Some</span>(<span class='ident'>Duration</span>(<span class='ident'>daytime</span>)), <span class='prelude-val'>Some</span>(<span class='ident'>Duration</span>(<span class='ident'>nighttime</span>)), <span class='prelude-val'>Some</span>(<span class='ident'>Time</span>(<span class='ident'>sunrise</span>))) <span class='op'>=</span> 
                                                  (<span class='self'>self</span>.<span class='ident'>daytime</span>(), <span class='self'>self</span>.<span class='ident'>nighttime</span>(), <span class='self'>self</span>.<span class='ident'>sunrise</span>()) {
            <span class='kw'>let</span> <span class='ident'>time</span> <span class='op'>=</span> (<span class='ident'>time</span> <span class='op'>-</span> <span class='ident'>sunrise</span>).<span class='number'>0</span>;
            
            <span class='comment'>// if within current self&#39;s day/night</span>
            <span class='kw'>if</span> <span class='ident'>time</span> <span class='op'>&lt;=</span> <span class='ident'>daytime</span> <span class='op'>+</span> <span class='ident'>nighttime</span> <span class='op'>&amp;&amp;</span> <span class='ident'>time</span> <span class='op'>&gt;=</span> <span class='number'>0</span> {
                <span class='kw'>if</span> <span class='ident'>time</span> <span class='op'>&lt;=</span> <span class='ident'>daytime</span> {
                    <span class='prelude-val'>Some</span>(<span class='ident'>time</span> <span class='kw'>as</span> <span class='ident'>f64</span><span class='op'>/</span><span class='ident'>daytime</span> <span class='kw'>as</span> <span class='ident'>f64</span>)
                }
                <span class='kw'>else</span> {
                    <span class='prelude-val'>Some</span>(<span class='number'>1.0</span> <span class='op'>+</span> (<span class='ident'>time</span><span class='op'>-</span><span class='ident'>daytime</span>) <span class='kw'>as</span> <span class='ident'>f64</span><span class='op'>/</span><span class='ident'>nighttime</span> <span class='kw'>as</span> <span class='ident'>f64</span>)
                }
            }
            <span class='kw'>else</span> {
                <span class='prelude-val'>None</span>
            }
        }
        <span class='kw'>else</span> {
            <span class='prelude-val'>None</span>
        }
    }
}


<span class='doccomment'>/// Iterates over every day of a given year, yielding a</span>
<span class='doccomment'>/// ShamsDay object for each day. </span>
<span class='doccomment'>/// </span>
<span class='doccomment'>/// See ShamsSpec for generating an instance.</span>
<span class='kw'>pub</span> <span class='kw'>struct</span> <span class='ident'>YearIter</span> {
    <span class='ident'>spec</span>        : <span class='ident'>ShamsSpec</span>,
    <span class='ident'>day</span>         : <span class='ident'>u16</span>,
    <span class='ident'>month</span>       : <span class='ident'>u16</span>,
    <span class='ident'>year</span>        : <span class='ident'>u16</span>,
    <span class='ident'>dim</span>: <span class='kw-2'>&amp;</span><span class='lifetime'>&#39;static</span> [<span class='ident'>u16</span>]
}
<span class='kw'>impl</span> <span class='ident'>YearIter</span> {
    <span class='kw'>fn</span> <span class='ident'>new</span>(<span class='ident'>spec</span>: <span class='kw-2'>&amp;</span><span class='ident'>ShamsSpec</span>, <span class='ident'>year</span>: <span class='ident'>u16</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Result</span><span class='op'>&lt;</span><span class='ident'>YearIter</span>, <span class='ident'>String</span><span class='op'>&gt;</span> {
        <span class='kw'>use</span> ::<span class='ident'>date</span>::<span class='ident'>month_list</span>;
        <span class='kw'>if</span> <span class='kw'>let</span> <span class='prelude-val'>Err</span>(<span class='ident'>e</span>) <span class='op'>=</span> <span class='ident'>spec</span>.<span class='ident'>clone</span>().<span class='ident'>date</span>(<span class='ident'>year</span>, <span class='number'>1</span>, <span class='number'>1</span>).<span class='ident'>calculate</span>() {
            <span class='kw'>return</span> <span class='prelude-val'>Err</span>(<span class='ident'>e</span>);
        }
        <span class='kw'>else</span> {
            <span class='prelude-val'>Ok</span>(<span class='ident'>YearIter</span>{    <span class='ident'>dim</span>:<span class='ident'>month_list</span>(<span class='ident'>year</span>),
                            <span class='ident'>spec</span>:<span class='op'>*</span><span class='ident'>spec</span>,
                            <span class='ident'>year</span>:<span class='ident'>year</span>,
                            <span class='ident'>month</span>:<span class='number'>0</span>,
                            <span class='ident'>day</span>:<span class='number'>0</span>               })
        }
    }
}
<span class='kw'>impl</span> <span class='ident'>Iterator</span> <span class='kw'>for</span> <span class='ident'>YearIter</span> {
    <span class='kw'>type</span> <span class='ident'>Item</span><span class='op'>=</span><span class='ident'>ShamsDay</span>;
    <span class='kw'>fn</span> <span class='ident'>next</span>(<span class='kw-2'>&amp;</span><span class='kw-2'>mut</span> <span class='self'>self</span>) <span class='op'>-&gt;</span> <span class='prelude-ty'>Option</span><span class='op'>&lt;</span><span class='ident'>ShamsDay</span><span class='op'>&gt;</span> {
        <span class='kw'>if</span> <span class='self'>self</span>.<span class='ident'>day</span> <span class='op'>==</span> <span class='self'>self</span>.<span class='ident'>dim</span>[<span class='self'>self</span>.<span class='ident'>month</span> <span class='kw'>as</span> <span class='ident'>usize</span>] {
            <span class='self'>self</span>.<span class='ident'>day</span> <span class='op'>=</span> <span class='number'>0</span>;
            <span class='self'>self</span>.<span class='ident'>month</span> <span class='op'>+=</span> <span class='number'>1</span>;
            <span class='kw'>if</span> <span class='self'>self</span>.<span class='ident'>month</span> <span class='kw'>as</span> <span class='ident'>usize</span> <span class='op'>==</span> <span class='self'>self</span>.<span class='ident'>dim</span>.<span class='ident'>len</span>() {
                <span class='kw'>return</span> <span class='prelude-val'>None</span>;
            }
        }
        <span class='self'>self</span>.<span class='ident'>day</span> <span class='op'>+=</span> <span class='number'>1</span>;
        <span class='self'>self</span>.<span class='ident'>spec</span>.<span class='ident'>date</span>(<span class='self'>self</span>.<span class='ident'>year</span>, <span class='self'>self</span>.<span class='ident'>month</span><span class='op'>+</span><span class='number'>1</span>, <span class='self'>self</span>.<span class='ident'>day</span>);
        <span class='prelude-val'>Some</span>(<span class='self'>self</span>.<span class='ident'>spec</span>.<span class='ident'>calculate</span>().<span class='ident'>unwrap_or_else</span>(<span class='op'>|</span><span class='ident'>e</span><span class='op'>|</span> 
            <span class='macro'>panic</span><span class='macro'>!</span>(<span class='macro'>concat</span><span class='macro'>!</span>(<span class='string'>&quot;This is an unreported bug in the &quot;</span>,
                           <span class='string'>&quot;library, please report it with a &quot;</span>,
                           <span class='string'>&quot;method to reproduce it: {}&quot;</span>), <span class='ident'>e</span>)))
    }
}

</pre>
</section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <div id="help" class="hidden">
        <div class="shortcuts">
            <h1>Keyboard shortcuts</h1>
            <dl>
                <dt>?</dt>
                <dd>Show this help dialog</dd>
                <dt>S</dt>
                <dd>Focus the search field</dd>
                <dt>&larrb;</dt>
                <dd>Move up in search results</dd>
                <dt>&rarrb;</dt>
                <dd>Move down in search results</dd>
                <dt>&#9166;</dt>
                <dd>Go to active search result</dd>
            </dl>
        </div>
        <div class="infos">
            <h1>Search tricks</h1>
            <p>
                Prefix searches with a type followed by a colon (e.g.
                <code>fn:</code>) to restrict the search to a given type.
            </p>
            <p>
                Accepted types are: <code>fn</code>, <code>mod</code>,
                <code>struct</code>, <code>enum</code>,
                <code>trait</code>, <code>typedef</code> (or
                <code>tdef</code>).
            </p>
            <p>
                Search functions by type signature (e.g.
                <code>vec -> usize</code>)
            </p>
        </div>
    </div>

    

    <script>
        window.rootPath = "../../";
        window.currentCrate = "shams";
        window.playgroundUrl = "";
    </script>
    <script src="../../jquery.js"></script>
    <script src="../../main.js"></script>
    
    <script async src="../../search-index.js"></script>
</body>
</html>